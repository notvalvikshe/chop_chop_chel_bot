# ‚úÖ –ß–µ–∫–ª–∏—Å—Ç –¥–µ–ø–ª–æ—è –Ω–∞ VPS

–ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ —ç—Ç–æ—Ç —á–µ–∫–ª–∏—Å—Ç –¥–ª—è –±—ã—Å—Ç—Ä–æ–≥–æ —Ä–∞–∑–≤–µ—Ä—Ç—ã–≤–∞–Ω–∏—è –±–æ—Ç–∞ –Ω–∞ –≤–∞—à–µ–º VPS.

## üìã –ü–µ—Ä–µ–¥ –Ω–∞—á–∞–ª–æ–º

–í–∞–º –ø–æ–Ω–∞–¥–æ–±–∏—Ç—Å—è:
- [ ] VPS —Å–µ—Ä–≤–µ—Ä (Ubuntu 20.04+ –∏–ª–∏ Debian 11+)
- [ ] SSH –¥–æ—Å—Ç—É–ø –∫ —Å–µ—Ä–≤–µ—Ä—É
- [ ] GitHub —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏–π (—Å–æ–∑–¥–∞–π—Ç–µ, –µ—Å–ª–∏ –µ—â–µ –Ω–µ—Ç)
- [ ] –í—Å–µ —Ç–æ–∫–µ–Ω—ã –∏ ID –¥–ª—è YClients

---

## üñ•Ô∏è –ß–∞—Å—Ç—å 1: –ü–æ–¥–≥–æ—Ç–æ–≤–∫–∞ VPS

### 1. –ü–æ–¥–∫–ª—é—á–µ–Ω–∏–µ –∫ VPS

```bash
ssh your_user@your_vps_ip
```

### 2. –£—Å—Ç–∞–Ω–æ–≤–∫–∞ Docker

```bash
curl -fsSL https://get.docker.com -o get-docker.sh
sudo sh get-docker.sh
sudo usermod -aG docker $USER
```

- [ ] Docker —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω
- [ ] –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –¥–æ–±–∞–≤–ª–µ–Ω –≤ –≥—Ä—É–ø–ø—É docker

### 3. –£—Å—Ç–∞–Ω–æ–≤–∫–∞ Docker Compose –∏ Git

```bash
sudo apt update
sudo apt install docker-compose-plugin git -y
```

- [ ] Docker Compose —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω
- [ ] Git —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω

### 4. –ü–µ—Ä–µ–∑–∞–π—Ç–∏ –≤ —Å–∏—Å—Ç–µ–º—É

```bash
exit
# –ó–∞—Ç–µ–º —Å–Ω–æ–≤–∞: ssh your_user@your_vps_ip
```

- [ ] –ü–µ—Ä–µ–ø–æ–¥–∫–ª—é—á–∏–ª–∏—Å—å –¥–ª—è –ø—Ä–∏–º–µ–Ω–µ–Ω–∏—è –ø—Ä–∞–≤ Docker

### 5. –°–æ–∑–¥–∞–Ω–∏–µ SSH –∫–ª—é—á–∞ –¥–ª—è GitHub

```bash
ssh-keygen -t ed25519 -C "your_email@example.com"
# –ù–∞–∂–º–∏—Ç–µ Enter 3 —Ä–∞–∑–∞ (–±–µ–∑ –ø–∞—Ä–æ–ª—è)

# –ü—Ä–æ—Å–º–æ—Ç—Ä –ø—É–±–ª–∏—á–Ω–æ–≥–æ –∫–ª—é—á–∞
cat ~/.ssh/id_ed25519.pub
```

- [ ] SSH –∫–ª—é—á —Å–æ–∑–¥–∞–Ω
- [ ] –ü—É–±–ª–∏—á–Ω—ã–π –∫–ª—é—á —Å–∫–æ–ø–∏—Ä–æ–≤–∞–Ω

### 6. –î–æ–±–∞–≤–ª–µ–Ω–∏–µ SSH –∫–ª—é—á–∞ –≤ GitHub

1. –û—Ç–∫—Ä–æ–π—Ç–µ GitHub ‚Üí Settings ‚Üí SSH and GPG keys ‚Üí New SSH key
2. –í—Å—Ç–∞–≤—å—Ç–µ –ø—É–±–ª–∏—á–Ω—ã–π –∫–ª—é—á –∏–∑ –ø—Ä–µ–¥—ã–¥—É—â–µ–≥–æ —à–∞–≥–∞
3. –ù–∞–∂–º–∏—Ç–µ "Add SSH key"

- [ ] SSH –∫–ª—é—á –¥–æ–±–∞–≤–ª–µ–Ω –≤ GitHub

---

## üì¶ –ß–∞—Å—Ç—å 2: –†–∞–∑–≤–µ—Ä—Ç—ã–≤–∞–Ω–∏–µ –ø—Ä–æ–µ–∫—Ç–∞

### 7. –ö–ª–æ–Ω–∏—Ä–æ–≤–∞–Ω–∏–µ —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏—è

```bash
cd ~
git clone git@github.com:YOUR_USERNAME/chop_chop_chel_bot.git
cd chop_chop_chel_bot
```

**–ó–∞–º–µ–Ω–∏—Ç–µ `YOUR_USERNAME` –Ω–∞ –≤–∞—à username –≤ GitHub!**

- [ ] –†–µ–ø–æ–∑–∏—Ç–æ—Ä–∏–π —Å–∫–ª–æ–Ω–∏—Ä–æ–≤–∞–Ω
- [ ] –ü–µ—Ä–µ—à–ª–∏ –≤ –¥–∏—Ä–µ–∫—Ç–æ—Ä–∏—é –ø—Ä–æ–µ–∫—Ç–∞

### 8. –°–æ–∑–¥–∞–Ω–∏–µ .env —Ñ–∞–π–ª–∞

```bash
nano .env
```

–í—Å—Ç–∞–≤—å—Ç–µ —Å–ª–µ–¥—É—é—â–µ–µ —Å–æ–¥–µ—Ä–∂–∏–º–æ–µ (–∏–∑–º–µ–Ω–∏—Ç–µ –∑–Ω–∞—á–µ–Ω–∏—è):

```env
ENV=production
PORT=3000

DB_PORT=5432
DB_USERNAME=postgres
DB_PASSWORD=–ò–ó–ú–ï–ù–ò–¢–ï_–ù–ê_–ë–ï–ó–û–ü–ê–°–ù–´–ô_–ü–ê–†–û–õ–¨
DB_NAME=chopbot
DATABASE_URL=postgresql://postgres:–ò–ó–ú–ï–ù–ò–¢–ï_–ù–ê_–ë–ï–ó–û–ü–ê–°–ù–´–ô_–ü–ê–†–û–õ–¨@postgres:5432/chopbot

TELEGRAM_TOKEN=–≤–∞—à_—Ç–æ–∫–µ–Ω_–±–æ—Ç–∞
YCLIENTS_PARTNER_TOKEN=–≤–∞—à_partner_token
YCLIENTS_USER_TOKEN=–≤–∞—à_user_token
YCLIENTS_PARTNER_ID=–≤–∞—à_partner_id
YCLIENTS_COMPANY_ID=–≤–∞—à_company_id
```

**–°–æ—Ö—Ä–∞–Ω–∏—Ç–µ:** `Ctrl+O`, `Enter`, `Ctrl+X`

- [ ] .env —Ñ–∞–π–ª —Å–æ–∑–¥–∞–Ω
- [ ] DB_PASSWORD –∏–∑–º–µ–Ω–µ–Ω –Ω–∞ –±–µ–∑–æ–ø–∞—Å–Ω—ã–π
- [ ] –í—Å–µ —Ç–æ–∫–µ–Ω—ã –∑–∞–ø–æ–ª–Ω–µ–Ω—ã

### 9. –ó–∞–ø—É—Å–∫ –±–æ—Ç–∞

```bash
docker compose -f docker-compose.prod.yml up -d --build
```

- [ ] –ö–æ–Ω—Ç–µ–π–Ω–µ—Ä—ã —Å–æ–±—Ä–∞–Ω—ã –∏ –∑–∞–ø—É—â–µ–Ω—ã

### 10. –ü—Ä–æ–≤–µ—Ä–∫–∞ –ª–æ–≥–æ–≤

```bash
docker compose -f docker-compose.prod.yml logs -f bot
```

**–ù–∞–∂–º–∏—Ç–µ `Ctrl+C` –¥–ª—è –≤—ã—Ö–æ–¥–∞ –∏–∑ –ª–æ–≥–æ–≤**

- [ ] –ë–æ—Ç —É—Å–ø–µ—à–Ω–æ –∑–∞–ø—É—Å—Ç–∏–ª—Å—è
- [ ] –í –ª–æ–≥–∞—Ö –Ω–µ—Ç –æ—à–∏–±–æ–∫
- [ ] –ë–æ—Ç –æ—Ç–≤–µ—á–∞–µ—Ç –≤ Telegram

---

## üîÑ –ß–∞—Å—Ç—å 3: –ù–∞—Å—Ç—Ä–æ–π–∫–∞ –∞–≤—Ç–æ–¥–µ–ø–ª–æ—è —á–µ—Ä–µ–∑ GitHub Actions

### 11. –°–æ–∑–¥–∞–Ω–∏–µ SSH –∫–ª—é—á–∞ –¥–ª—è GitHub Actions (–Ω–∞ –ª–æ–∫–∞–ª—å–Ω–æ–º –ü–ö)

```bash
ssh-keygen -t ed25519 -C "github-actions" -f ~/.ssh/github_actions_key -N ""
```

- [ ] –ö–ª—é—á —Å–æ–∑–¥–∞–Ω

### 12. –ö–æ–ø–∏—Ä–æ–≤–∞–Ω–∏–µ –ø—É–±–ª–∏—á–Ω–æ–≥–æ –∫–ª—é—á–∞

```bash
cat ~/.ssh/github_actions_key.pub
```

- [ ] –ü—É–±–ª–∏—á–Ω—ã–π –∫–ª—é—á —Å–∫–æ–ø–∏—Ä–æ–≤–∞–Ω

### 13. –î–æ–±–∞–≤–ª–µ–Ω–∏–µ –ø—É–±–ª–∏—á–Ω–æ–≥–æ –∫–ª—é—á–∞ –Ω–∞ VPS

–ù–∞ VPS —Å–µ—Ä–≤–µ—Ä–µ –≤—ã–ø–æ–ª–Ω–∏—Ç–µ:

```bash
nano ~/.ssh/authorized_keys
```

–í—Å—Ç–∞–≤—å—Ç–µ –ø—É–±–ª–∏—á–Ω—ã–π –∫–ª—é—á –≤ –Ω–æ–≤—É—é —Å—Ç—Ä–æ–∫—É –≤ –∫–æ–Ω—Ü–µ —Ñ–∞–π–ª–∞.

**–°–æ—Ö—Ä–∞–Ω–∏—Ç–µ:** `Ctrl+O`, `Enter`, `Ctrl+X`

–£—Å—Ç–∞–Ω–æ–≤–∏—Ç–µ –ø—Ä–∞–≤–∞:

```bash
chmod 600 ~/.ssh/authorized_keys
```

- [ ] –ü—É–±–ª–∏—á–Ω—ã–π –∫–ª—é—á –¥–æ–±–∞–≤–ª–µ–Ω –Ω–∞ VPS
- [ ] –ü—Ä–∞–≤–∞ —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω—ã

### 14. –ö–æ–ø–∏—Ä–æ–≤–∞–Ω–∏–µ –ø—Ä–∏–≤–∞—Ç–Ω–æ–≥–æ –∫–ª—é—á–∞ (–Ω–∞ –ª–æ–∫–∞–ª—å–Ω–æ–º –ü–ö)

```bash
cat ~/.ssh/github_actions_key
```

**–°–∫–æ–ø–∏—Ä—É–π—Ç–µ –≤–µ—Å—å –≤—ã–≤–æ–¥, –≤–∫–ª—é—á–∞—è —Å—Ç—Ä–æ–∫–∏ `-----BEGIN` –∏ `-----END`**

- [ ] –ü—Ä–∏–≤–∞—Ç–Ω—ã–π –∫–ª—é—á —Å–∫–æ–ø–∏—Ä–æ–≤–∞–Ω

### 15. –£–∑–Ω–∞–π—Ç–µ –ø—É—Ç—å –∫ –ø—Ä–æ–µ–∫—Ç—É –Ω–∞ VPS

–ù–∞ VPS –≤—ã–ø–æ–ª–Ω–∏—Ç–µ:

```bash
pwd
```

–û–±—ã—á–Ω–æ —ç—Ç–æ –±—É–¥–µ—Ç `/root/chop_chop_chel_bot` –∏–ª–∏ `/home/username/chop_chop_chel_bot`

- [ ] –ü—É—Ç—å –∫ –ø—Ä–æ–µ–∫—Ç—É –∑–∞–ø–∏—Å–∞–Ω

### 16. –ù–∞—Å—Ç—Ä–æ–π–∫–∞ GitHub Secrets

1. –û—Ç–∫—Ä–æ–π—Ç–µ —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏–π –Ω–∞ GitHub
2. Settings ‚Üí Secrets and variables ‚Üí Actions ‚Üí New repository secret
3. –î–æ–±–∞–≤—å—Ç–µ —Å–ª–µ–¥—É—é—â–∏–µ —Å–µ–∫—Ä–µ—Ç—ã:

| Name | Value | –ì–æ—Ç–æ–≤–æ |
|------|-------|--------|
| `VPS_HOST` | IP –∞–¥—Ä–µ—Å –≤–∞—à–µ–≥–æ VPS (–Ω–∞–ø—Ä–∏–º–µ—Ä: `123.45.67.89`) | [ ] |
| `VPS_USER` | –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å SSH (–Ω–∞–ø—Ä–∏–º–µ—Ä: `root` –∏–ª–∏ `ubuntu`) | [ ] |
| `VPS_PORT` | –ü–æ—Ä—Ç SSH (–æ–±—ã—á–Ω–æ `22`) | [ ] |
| `VPS_SSH_KEY` | –ü—Ä–∏–≤–∞—Ç–Ω—ã–π –∫–ª—é—á –∏–∑ —à–∞–≥–∞ 14 | [ ] |
| `VPS_PROJECT_PATH` | –ü—É—Ç—å –∏–∑ —à–∞–≥–∞ 15 (–Ω–∞–ø—Ä–∏–º–µ—Ä: `/root/chop_chop_chel_bot`) | [ ] |

- [ ] –í—Å–µ 5 —Å–µ–∫—Ä–µ—Ç–æ–≤ –¥–æ–±–∞–≤–ª–µ–Ω—ã

---

## üéâ –ß–∞—Å—Ç—å 4: –ü—Ä–æ–≤–µ—Ä–∫–∞ —Ä–∞–±–æ—Ç—ã

### 17. –¢–µ—Å—Ç –∞–≤—Ç–æ–¥–µ–ø–ª–æ—è

–ù–∞ –ª–æ–∫–∞–ª—å–Ω–æ–º –∫–æ–º–ø—å—é—Ç–µ—Ä–µ:

```bash
git add .
git commit -m "Test deploy"
git push origin main
```

–ó–∞—Ç–µ–º:
1. –û—Ç–∫—Ä–æ–π—Ç–µ GitHub ‚Üí –≤–∞—à —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏–π ‚Üí Actions
2. –î–æ–∂–¥–∏—Ç–µ—Å—å –∑–∞–≤–µ—Ä—à–µ–Ω–∏—è workflow

- [ ] Workflow –∑–∞–ø—É—Å—Ç–∏–ª—Å—è
- [ ] Workflow –∑–∞–≤–µ—Ä—à–∏–ª—Å—è —É—Å–ø–µ—à–Ω–æ (–∑–µ–ª–µ–Ω–∞—è –≥–∞–ª–æ—á–∫–∞)
- [ ] –ë–æ—Ç –ø—Ä–æ–¥–æ–ª–∂–∞–µ—Ç —Ä–∞–±–æ—Ç–∞—Ç—å

### 18. –ü—Ä–æ–≤–µ—Ä–∫–∞ –±–æ—Ç–∞ –≤ Telegram

1. –û—Ç–∫—Ä–æ–π—Ç–µ –±–æ—Ç–∞ –≤ Telegram
2. –û—Ç–ø—Ä–∞–≤—å—Ç–µ –∫–æ–º–∞–Ω–¥—É `/start`
3. –ü–æ–ø—Ä–æ–±—É–π—Ç–µ —Å–æ–∑–¥–∞—Ç—å –∑–∞–ø–∏—Å—å

- [ ] –ë–æ—Ç –æ—Ç–≤–µ—á–∞–µ—Ç
- [ ] –ú–æ–∂–Ω–æ —Å–æ–∑–¥–∞—Ç—å –∑–∞–ø–∏—Å—å
- [ ] –ó–∞–ø–∏—Å—å –ø–æ—è–≤–ª—è–µ—Ç—Å—è –≤ YClients

---

## üéØ –ì–æ—Ç–æ–≤–æ!

–¢–µ–ø–µ—Ä—å –≤–∞—à –±–æ—Ç:
- ‚úÖ –†–∞–±–æ—Ç–∞–µ—Ç –Ω–∞ VPS
- ‚úÖ –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –æ–±–Ω–æ–≤–ª—è–µ—Ç—Å—è –ø—Ä–∏ push –≤ main/master
- ‚úÖ –ò—Å–ø–æ–ª—å–∑—É–µ—Ç PostgreSQL –≤ Docker
- ‚úÖ –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –ø–µ—Ä–µ–∑–∞–ø—É—Å–∫–∞–µ—Ç—Å—è –ø—Ä–∏ —Å–±–æ—è—Ö

## üìö –ü–æ–ª–µ–∑–Ω—ã–µ –∫–æ–º–∞–Ω–¥—ã

```bash
# –ü—Ä–æ—Å–º–æ—Ç—Ä –ª–æ–≥–æ–≤
docker compose -f docker-compose.prod.yml logs -f bot

# –ü–µ—Ä–µ–∑–∞–ø—É—Å–∫ –±–æ—Ç–∞
docker compose -f docker-compose.prod.yml restart bot

# –û—Å—Ç–∞–Ω–æ–≤–∫–∞ –≤—Å–µ—Ö —Å–µ—Ä–≤–∏—Å–æ–≤
docker compose -f docker-compose.prod.yml down

# –°—Ç–∞—Ç—É—Å –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–æ–≤
docker compose -f docker-compose.prod.yml ps

# –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ –≤—Ä—É—á–Ω—É—é (–µ—Å–ª–∏ –Ω—É–∂–Ω–æ)
git pull && docker compose -f docker-compose.prod.yml up -d --build
```

## üÜò –ü–æ–º–æ—â—å

–ï—Å–ª–∏ —á—Ç–æ-—Ç–æ –ø–æ—à–ª–æ –Ω–µ —Ç–∞–∫:
- üìñ –ß–∏—Ç–∞–π—Ç–µ [QUICK_START.md](./QUICK_START.md) - –∫—Ä–∞—Ç–∫–æ–µ —Ä—É–∫–æ–≤–æ–¥—Å—Ç–≤–æ
- üìñ –ß–∏—Ç–∞–π—Ç–µ [DEPLOY.md](./DEPLOY.md) - –ø–æ–ª–Ω–∞—è –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è
- üìã –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –ª–æ–≥–∏: `docker compose -f docker-compose.prod.yml logs -f`

---

**–í—Å–µ –≥–æ—Ç–æ–≤–æ! –ü–æ–∑–¥—Ä–∞–≤–ª—è—é —Å —É—Å–ø–µ—à–Ω—ã–º –¥–µ–ø–ª–æ–µ–º! üöÄ**
